{% load staticfiles %}

{# Load the tag library #}
{% load bootstrap3 %}

<!DOCTYPE html>
<html lang="fr">
    <head>
        {# Load CSS and JavaScript #}
        {% bootstrap_css %}
        <link rel="stylesheet" href="{% static "/static/css/base.css" %}">

        {% bootstrap_javascript %}
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Re2o : {% block title %}Accueil{% endblock %}</title>
    </head>

    <body>
        <div id="wrap">
            <nav class="navbar navbar-inverse">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/">Re2o</a>
                    </div>
                    <div class="collapse navbar-collapse" id="myNavbar">
                        <ul class="nav navbar-nav">
                            <li><a href="{% url "users:mon-profil" %}">Mon profil</a></li>
                            {% if is_cableur %}
                            <li><a href="{% url "users:index" %}">Adhérents</a></li>
                            <li><a href="{% url "machines:index" %}">Machines</a></li>
                            <li><a href="{% url "cotisations:index" %}">Cotisations</a></li>
                            <li><a href="{% url "topologie:index" %}">Topologie</a></li>
                            <li><a href="#">Statistiques</a></li>
                            {% endif %}
                        </ul>
                        <div class="col-sm-3 col-md-3 navbar-right">
                            <form action="{% url "search:search"%}"  method="POST" class="navbar-form" role="search">
                                {% csrf_token %}
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Search" name="search_field" id="search-term">
                                    <div class="input-group-btn">
                                        <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
                                        <a href="{% url "search:searchp" %}" class="btn btn-default" role="button"><i class="glyphicon glyphicon-plus"></i></a>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                {% if request.user.is_authenticated %}
                                <a href="{% url 'logout' %}">
                                    <span class="glyphicon glyphicon-log-out"></span> Logout
                                </a>
                                {% else %}
                                <a href="{% url 'login' %}">
                                    <span class="glyphicon glyphicon-log-in"></span> Login
                                </a>
                                {% endif %}
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div id="main" class="container-fluid text-center">
                <div class="row content">
                    <div class="col-sm-2 sidenav">
                        {% block sidebar %}
                        {% endblock %}
                    </div>
                    <div class="col-sm-8 text-left">
                        {# Display django.contrib.messages as Bootstrap alerts #}
                        {% bootstrap_messages %}

                        <hr>

                        {% block content %}{% endblock %}
                    </div>
                    <div class="col-sm-2 sidenav">
                        <div class="well">
                            {% if request_user.is_authenticated %}
                            <li>{{ request_user.name }} {{ request_user.surname }}</li>
                            <li>Pseudo : {{ request_user.pseudo }}</li>
                            <li>Chambre : {{ request_user.room }}</li>
                            <li>Connexion : {% if request_user.has_access == True %}<font color="green">Active</font>{% else %}<font color="red">Désactivée</font>{% endif %}</li>
                            <li>Fin d'adhésion : {% if request_user.end_adhesion != None %}<font color="green">{{ request_user.end_adhesion }}</font>{% else %}<font color="red">Non adhérent</font>{% endif %}</li>
                            <p><a class="btn btn-success btn-sm" role="button"href="{% url "users:mon-profil" %}">Voir mon profil</a></p>
                            {% else %}
                            <p>Vous n'êtes pas authentifié</p>
                            {% endif %}
                        </div>
                        {% if request_user.is_authenticated %}
                        <div class="well">
                        {{ interfaces|length }} machines actives
                        {% for interface in interfaces|slice:":5" %}
                        <li>{{interface.dns}}</li>
                        {% endfor %}
                        <p><a class="btn btn-warning btn-sm" role="button" href="{% url "users:mon-profil" %}">Voir mes machines</a></p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <footer class="navbar">
            <div class="containerfluid text-center">
                <p>Re2o 2016 - Goulven Kermarec, Gabriel Détraz, Augustin Lemesle</p>
            </div>
        </footer>


        {# Read the documentation for more information #}
    </body>
</html>
